name: npmTest
description: Run npm test script and optionally publish JUnit results
inputs:
  workspace:
    description: Directory to run tests in
    required: false
    default: .
  script:
    description: NPM script to run
    required: false
    default: test
  publishJunit:
    description: Publish JUnit results
    required: false
    default: true
  junitPattern:
    description: JUnit results file pattern
    required: false
    default: '**/junit.xml'
runs:
  using: composite
  steps:
  - name: Run npm test script
    run: 'set -euo pipefail

      cd "${{ inputs.workspace }}"

      npm run ${{ inputs.script }} -- --ci --reporters=default --reporters=jest-junit

      '
    shell: bash
  - name: Publish JUnit results if enabled
    run: "if [ \"${{ inputs.publishJunit }}\" = \"true\" ]; then\n  echo \"Publishing\
      \ JUnit results from pattern: ${{ inputs.junitPattern }}\"\n  # Add your JUnit\
      \ publishing logic here, e.g., upload-artifact or a custom script\nelse\n  echo\
      \ \"JUnit publishing is disabled\"\nfi\n"
    shell: bash
